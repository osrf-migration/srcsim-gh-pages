{"links": {"self": {"href": "data/repositories/osrf/srcsim/issues/106/comments/35062518.json"}, "html": {"href": "#!/osrf/srcsim/issues/106#comment-35062518"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/srcsim/issues/106.json"}}, "type": "issue", "id": 106, "repository": {"links": {"self": {"href": "data/repositories/osrf/srcsim.json"}, "html": {"href": "#!/osrf/srcsim"}, "avatar": {"href": "data/bytebucket.org/ravatar/{c41021d9-0217-4628-999d-7f8d82f98dcb}ts=c_plus_plus"}}, "type": "repository", "name": "srcsim", "full_name": "osrf/srcsim", "uuid": "{c41021d9-0217-4628-999d-7f8d82f98dcb}"}, "title": "world frame does not go with tf across network"}, "content": {"raw": "@dan77062, I don't think it's just a network error.  I was getting that error as well when I started calling the keyboard_teleop class from my code.  I believe the issue is that the tfBuffer is not yet populated with a 'world' frame when you are asking it to step.  I added the following to the keyboard_teleop.py inside the init(self) method:\n\n```\n#!python\n# Wait for 'world' to be published\n        rospy.loginfo('waiting for world frame to populate tfBuffer...')\n        while True:\n            try: \n                left_foot_world = self.tfBuffer.lookup_transform(\n                    'world', self.LEFT_FOOT_FRAME_NAME, rospy.Time())\n                break\n            except:\n                rospy.sleep(0.5)\n        rospy.loginfo('Done initiallizing val controller')\n\n```\nIt's hackish, but it puts in a delay until the tfBuffer is populated and stopped the errors.", "markup": "markdown", "html": "<p>@dan77062, I don't think it's just a network error.  I was getting that error as well when I started calling the keyboard_teleop class from my code.  I believe the issue is that the tfBuffer is not yet populated with a 'world' frame when you are asking it to step.  I added the following to the keyboard_teleop.py inside the init(self) method:</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"c1\"># Wait for &#39;world&#39; to be published</span>\n        <span class=\"n\">rospy</span><span class=\"o\">.</span><span class=\"n\">loginfo</span><span class=\"p\">(</span><span class=\"s1\">&#39;waiting for world frame to populate tfBuffer...&#39;</span><span class=\"p\">)</span>\n        <span class=\"k\">while</span> <span class=\"bp\">True</span><span class=\"p\">:</span>\n            <span class=\"k\">try</span><span class=\"p\">:</span> \n                <span class=\"n\">left_foot_world</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">tfBuffer</span><span class=\"o\">.</span><span class=\"n\">lookup_transform</span><span class=\"p\">(</span>\n                    <span class=\"s1\">&#39;world&#39;</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">LEFT_FOOT_FRAME_NAME</span><span class=\"p\">,</span> <span class=\"n\">rospy</span><span class=\"o\">.</span><span class=\"n\">Time</span><span class=\"p\">())</span>\n                <span class=\"k\">break</span>\n            <span class=\"k\">except</span><span class=\"p\">:</span>\n                <span class=\"n\">rospy</span><span class=\"o\">.</span><span class=\"n\">sleep</span><span class=\"p\">(</span><span class=\"mf\">0.5</span><span class=\"p\">)</span>\n        <span class=\"n\">rospy</span><span class=\"o\">.</span><span class=\"n\">loginfo</span><span class=\"p\">(</span><span class=\"s1\">&#39;Done initiallizing val controller&#39;</span><span class=\"p\">)</span>\n</pre></div>\n\n\n<p>It's hackish, but it puts in a delay until the tfBuffer is populated and stopped the errors.</p>", "type": "rendered"}, "created_on": "2017-03-13T21:19:30.276643+00:00", "user": {"display_name": "Jedediyah Williams", "uuid": "{0ed73727-8e01-409a-a6fd-1554e16cd944}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B0ed73727-8e01-409a-a6fd-1554e16cd944%7D"}, "html": {"href": "https://bitbucket.org/%7B0ed73727-8e01-409a-a6fd-1554e16cd944%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1ce466e941d68c9b4cf1d88c67ce9d00d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJW-2.png"}}, "nickname": "Jedediyah", "type": "user", "account_id": "557058:dc7e05b7-d275-4ba5-8e1e-9f938ef11c7a"}, "updated_on": null, "type": "issue_comment", "id": 35062518}